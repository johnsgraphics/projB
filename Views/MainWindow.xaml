<!--  filename: F:\CabinetDoc Pro\Views\MainWindow.xaml  -->
<Window
    x:Class="CabinetDocProWpf.Views.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="CabinetDoc Pro"
    Width="1280"
    Height="768"
    Background="#F3F5FA"
    WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <!--  Sidebar Button Style  -->
        <Style x:Key="SidebarButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="FontSize" Value="15" />
            <Setter Property="FontWeight" Value="Normal" />
            <Setter Property="Padding" Value="16,12" />
            <Setter Property="Margin" Value="0,0,0,6" />
            <Setter Property="HorizontalContentAlignment" Value="Left" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border
                            x:Name="border"
                            Padding="{TemplateBinding Padding}"
                            Background="{TemplateBinding Background}"
                            CornerRadius="8">
                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#195058" />
                            </Trigger>
                            <Trigger Property="Tag" Value="Active">
                                <Setter TargetName="border" Property="Background" Value="#14B8A6" />
                                <Setter Property="FontWeight" Value="SemiBold" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--  Header Button Style (Exporter/Nouveau)  -->
        <Style x:Key="HeaderButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#2DD4BF" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Padding" Value="16,10" />
            <Setter Property="Margin" Value="0,0,8,0" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border
                            x:Name="border"
                            Padding="{TemplateBinding Padding}"
                            Background="{TemplateBinding Background}"
                            CornerRadius="8">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#14B8A6" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--  Style for dropdown menu items  -->
        <Style x:Key="DropdownMenuItemStyle" TargetType="Button">
            <Setter Property="Background" Value="White" />
            <Setter Property="Foreground" Value="#1F2937" />
            <Setter Property="FontSize" Value="13" />
            <Setter Property="Padding" Value="16,10" />
            <Setter Property="HorizontalContentAlignment" Value="Left" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border
                            x:Name="border"
                            Padding="{TemplateBinding Padding}"
                            Background="{TemplateBinding Background}">
                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#F3F4F6" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition x:Name="SidebarColumn" Width="240" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <!--  SIDEBAR  -->
        <Border
            x:Name="SidebarBorder"
            Grid.Column="0"
            Background="#25545A">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="72" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <!--  Sidebar Header (Logo + Toggle)  -->
                <Grid Grid.Row="0" Background="#25545A">
                    <Grid Margin="12,16">
                        <!--  Logo (Left)  -->
                        <Border
                            Width="36"
                            Height="36"
                            HorizontalAlignment="Left"
                            Background="#10B981"
                            CornerRadius="6">
                            <TextBlock
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FontSize="16"
                                Foreground="White"
                                Text="📊" />
                        </Border>

                        <!--  App Name (Center - Hidden when collapsed)  -->
                        <StackPanel
                            x:Name="AppNamePanel"
                            Margin="52,0,0,0"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center">
                            <TextBlock
                                FontSize="13"
                                FontWeight="Bold"
                                Foreground="White"
                                Text="CabinetDoc Pro" />
                            <TextBlock
                                FontSize="10"
                                Foreground="#9CA3AF"
                                Text="Gestion Comptable" />
                        </StackPanel>

                        <!--  Toggle Button (Right)  -->
                        <Button
                            x:Name="ToggleButton"
                            Width="36"
                            Height="36"
                            HorizontalAlignment="Right"
                            Background="#374151"
                            BorderThickness="0"
                            Click="ToggleButton_Click"
                            Content="☰"
                            Cursor="Hand"
                            FontSize="14"
                            Foreground="White"
                            ToolTip="Réduire/agrandir le menu">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="{TemplateBinding Background}" CornerRadius="6">
                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                    </Border>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                    </Grid>
                </Grid>

                <!--  Navigation Menu  -->
                <StackPanel Grid.Row="1" Margin="8,20,8,0">
                    <!--  Dashboard  -->
                    <Button
                        x:Name="BtnDashboard"
                        Click="BtnDashboard_Click"
                        Style="{StaticResource SidebarButtonStyle}"
                        Tag="Active">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock
                                Width="32"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FontSize="18"
                                Foreground="White"
                                Text="📊" />
                            <TextBlock
                                x:Name="TxtDashboard"
                                Margin="4,0,0,0"
                                VerticalAlignment="Center"
                                FontSize="13"
                                Foreground="White"
                                Text="Tableau de Bord" />
                        </StackPanel>
                    </Button>

                    <!--  Créer (with dropdown)  -->
                    <Grid>
                        <Button
                            x:Name="BtnCreate"
                            Click="BtnCreate_Click"
                            Style="{StaticResource SidebarButtonStyle}">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Width="32"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    FontSize="18"
                                    Foreground="White"
                                    Text="➕" />
                                <TextBlock
                                    x:Name="TxtCreate"
                                    Margin="4,0,0,0"
                                    VerticalAlignment="Center"
                                    FontSize="13"
                                    Foreground="#D1D5DB"
                                    Text="Créer" />
                            </StackPanel>
                        </Button>

                        <!--  Dropdown Menu (initially hidden) - NOW BELOW BUTTON  -->
                        <Popup
                            x:Name="CreateDropdown"
                            AllowsTransparency="True"
                            Placement="Bottom"
                            PlacementTarget="{Binding ElementName=BtnCreate}"
                            StaysOpen="False">
                            <Border
                                Background="White"
                                BorderBrush="#E5E7EB"
                                BorderThickness="1"
                                CornerRadius="6"
                                Padding="4"
                                Margin="8,4,0,0">
                                <Border.Effect>
                                    <DropShadowEffect
                                        BlurRadius="10"
                                        Direction="270"
                                        Opacity="0.2"
                                        ShadowDepth="2" />
                                </Border.Effect>
                                <StackPanel Width="210">
                                    <Button
                                        Click="BtnNoteHonoraire_Click"
                                        Content="Note d'Honoraires"
                                        Style="{StaticResource DropdownMenuItemStyle}" />
                                    <Button
                                        Click="BtnRapportSpecial_Click"
                                        Content="Rapport Spécial"
                                        Style="{StaticResource DropdownMenuItemStyle}" />
                                </StackPanel>
                            </Border>
                        </Popup>
                    </Grid>

                    <!--  Clients  -->
                    <Button
                        x:Name="BtnClients"
                        Click="BtnClients_Click"
                        Style="{StaticResource SidebarButtonStyle}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock
                                Width="32"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FontSize="18"
                                Foreground="White"
                                Text="👥" />
                            <TextBlock
                                x:Name="TxtClients"
                                Margin="4,0,0,0"
                                VerticalAlignment="Center"
                                FontSize="13"
                                Foreground="#D1D5DB"
                                Text="Clients" />
                        </StackPanel>
                    </Button>

                    <!--  Documents  -->
                    <Button
                        x:Name="BtnDocuments"
                        Click="BtnDocuments_Click"
                        Style="{StaticResource SidebarButtonStyle}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock
                                Width="32"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FontSize="18"
                                Foreground="White"
                                Text="📄" />
                            <TextBlock
                                x:Name="TxtDocuments"
                                Margin="4,0,0,0"
                                VerticalAlignment="Center"
                                FontSize="13"
                                Foreground="#D1D5DB"
                                Text="Documents" />
                        </StackPanel>
                    </Button>

                    <!--  Paramètres  -->
                    <Button
                        x:Name="BtnSettings"
                        Click="BtnSettings_Click"
                        Style="{StaticResource SidebarButtonStyle}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock
                                Width="32"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FontSize="18"
                                Foreground="White"
                                Text="⚙️" />
                            <TextBlock
                                x:Name="TxtSettings"
                                Margin="4,0,0,0"
                                VerticalAlignment="Center"
                                FontSize="13"
                                Foreground="#D1D5DB"
                                Text="Paramètres" />
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <!--  MAIN CONTENT AREA  -->
        <Grid Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="64" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <!--  HEADER (No logos — clean design)  -->
            <Grid Grid.Row="0" Background="#25545A">
                <!--  Wave Background SVG Overlay  -->
                <Image
                    IsHitTestVisible="False"
                    Opacity="0.15"
                    Source="pack://application:,,,/Assets/wave-header-01.svg"
                    Stretch="Fill" />

                <!--  Header Content (Buttons only on left)  -->
                <StackPanel
                    Margin="20,0"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Center"
                    Orientation="Horizontal">
                    <Button
                        Click="BtnExport_Click"
                        Content="Exporter"
                        Style="{StaticResource HeaderButtonStyle}" />
                    <Button
                        Click="BtnNew_Click"
                        Content="Nouveau"
                        Style="{StaticResource HeaderButtonStyle}" />
                </StackPanel>
            </Grid>

            <!--  PAGES FRAME  -->
            <Frame
                x:Name="MainFrame"
                Grid.Row="1"
                Background="White"
                NavigationUIVisibility="Hidden" />
        </Grid>
    </Grid>
</Window>
